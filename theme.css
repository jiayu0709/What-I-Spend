/* theme.css — 全站統一色彩（Design Tokens） */

/* =========================
   0) Design Tokens
   ========================= */
:root{
  /* Backgrounds */
  --app-bg: #f0e6e6;
  --card-bg: #e0cdcc;

  /* Text */
  --text: #735f5c;
  --secondary: rgba(0,0,0,0.45);

  /* Lines */
  --divider: rgba(0,0,0,0.10);

  /* Status */
  --green: #2e9e4b;
  --red: #d94a4a;

  /* Accent */
  --accent: #4f55d8;
  --accent-text: #7b6a6c;

  /* Layout tokens */
  --page-padding: 16px;
  --radius: 16px;
  --tab-height: 84px;
  --tabcolor: #503d32;

  /* UI sizing */
  --topbar-offset: 10px;
  --page-top-pad: 18px;
  --drawer-pad: 14px;
  --hamburger-size: 44px;

  /* Drawer width (2/3 screen) */
  --drawer-width: 66.6667vw;
}

/* =========================
   1) Base
   ========================= */
body{
  background: var(--app-bg);
  color: var(--text);
  padding-top: 0; /* 背景要吃滿最上方 */
}

/* iPhone notch safe-area（只推內容，不推背景） */
main.page{
  padding-top: calc(var(--page-top-pad) + env(safe-area-inset-top, 0px)) !important;
}
.topbar{
  top: calc(var(--topbar-offset) + env(safe-area-inset-top, 0px)) !important;
}

/* =========================
   2) iOS input text color
   ========================= */
input[type="date"],
input[type="time"]{
  color: var(--accent-text);
  -webkit-text-fill-color: var(--accent-text);
}

input[type="date"]::-webkit-datetime-edit,
input[type="time"]::-webkit-datetime-edit{
  color: var(--accent-text);
}

input[type="date"]::-webkit-datetime-edit-text,
input[type="date"]::-webkit-datetime-edit-month-field,
input[type="date"]::-webkit-datetime-edit-day-field,
input[type="date"]::-webkit-datetime-edit-year-field,
input[type="time"]::-webkit-datetime-edit-text,
input[type="time"]::-webkit-datetime-edit-hour-field,
input[type="time"]::-webkit-datetime-edit-minute-field,
input[type="time"]::-webkit-datetime-edit-ampm-field{
  color: var(--accent-text);
}

/* =========================
   3) Page transition (iOS style)
   ========================= */
main.page{ animation: page-enter .25s ease-out; }
@keyframes page-enter{
  from{ opacity:0; transform: translateX(20px); }
  to  { opacity:1; transform: translateX(0); }
}
main.page.leaving{ animation: page-leave .2s ease-in forwards; }
@keyframes page-leave{
  from{ opacity:1; transform: translateX(0); }
  to  { opacity:0; transform: translateX(-20px); }
}

/* =========================
   4) Tap feedback (GLOBAL)
   ========================= */
a, button, .tx, .tab{ -webkit-tap-highlight-color: transparent; }

.tx, .tab, button{
  user-select:none;
  -webkit-user-select:none;
  transition: opacity .15s ease, transform .10s ease, background-color .15s ease;
}

.tx:active{ opacity:.6; transform:scale(.995); }
.tab:active{ opacity:.6; transform:scale(.98); }
button:active{ opacity:.65; transform:scale(.98); }

.tx:focus, .tab:focus, button:focus{ outline:none; }

/* =========================
   5) Tabbar (GLOBAL)
   ========================= */
.tabbar{
  position:fixed; left:0; right:0; bottom:0;
  height: var(--tab-height);
  background: rgba(255,255,255,0.65);
  backdrop-filter: blur(18px);
  border-top: 1px solid rgba(0,0,0,0.08);
  display:flex;
  justify-content:center;
}

.tabbar-inner{
  max-width:520px;
  width:100%;
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  padding:10px 18px 18px;
  gap:6px;
  align-items:center;
}

.tabbar .tab{
  text-decoration:none;
  color: var(--secondary);
  display:grid;
  place-items:center;
  gap:6px;
  font-weight:800;
  padding:8px 0;
}

.tabbar .tab .icon{
  font-size:24px;
  line-height:1;
  color: inherit;
}

.tabbar .tab.active{ color: var(--tabcolor); }

/* =========================
   6) Topbar + Hamburger
   ========================= */
.topbar{
  position: fixed;
  left: 10px;
  z-index: 50;
}

.hamburger{
  width: var(--hamburger-size);
  height: var(--hamburger-size);
  border-radius: 14px;
  background: transparent;
  border: 0;
  backdrop-filter: none;
  -webkit-backdrop-filter: none;
  display: flex;
  flex-direction: column;
  place-items: center;
  justify-content: center;
  gap: 6px;
  padding: 0;
  cursor: pointer;
}

.hamburger:active{ opacity:.65; transform:scale(.98); }

.hamburger span{
  display:block;
  width: 18px;
  height: 2px;
  background: var(--text);
  border-radius: 999px;
  opacity: .9;
  margin:0;
}

/* =========================
   7) Drawer Overlay + Base Drawer
   ========================= */
.drawer-backdrop{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.20);
  z-index: 80;
}

/* overlay polish */
.drawer-overlay{
  background: rgba(0,0,0,0.24) !important;
  backdrop-filter: blur(2px);
  -webkit-backdrop-filter: blur(2px);
}

/* drawer base */
.drawer{
  position: fixed;
  top: 0;
  left: 0;
  bottom: 0;
  height: 100dvh;

  width: var(--drawer-width);
  max-width: var(--drawer-width);

  background: var(--card-bg);
  border-right: 1px solid rgba(0,0,0,0.08);
  z-index: 90;

  /* 收合/展開位移（不要被別的 transform 覆蓋） */
  transform: translateX(-105%) translateZ(0);
  transition: transform .22s ease;

  padding: 0;
}

.drawer.open{
  transform: translateX(0) translateZ(0);
}

/* drawer content */
.drawer-inner{
  display:grid;
  gap: 12px;
  padding: var(--drawer-pad);
  padding-top: calc(var(--drawer-pad) + env(safe-area-inset-top));
  padding-bottom: calc(var(--drawer-pad) + env(safe-area-inset-bottom));
}

.drawer-link{
  display:block;
  text-decoration:none;
}

/* =========================
   8) Drawer “Premium” Panel (visual only)
   ========================= */
.drawer.drawer-panel{
  height: 100dvh;

  border-top-right-radius: 28px;
  border-bottom-right-radius: 28px;

  box-shadow:
    0 24px 70px rgba(0,0,0,0.18),
    0 8px 18px rgba(0,0,0,0.10),
    inset -1px 0 0 rgba(255,255,255,0.35),
    inset 0 1px 0 rgba(255,255,255,0.55);

  border-right: 1px solid rgba(0,0,0,0.06);

  background:
    radial-gradient(120% 60% at 18% 0%,
      rgba(255,255,255,0.55) 0%,
      rgba(255,255,255,0.16) 45%,
      rgba(255,255,255,0.00) 70%),
    linear-gradient(to bottom,
      rgba(255,255,255,0.26) 0px,
      rgba(255,255,255,0.10) 70px,
      rgba(255,255,255,0.00) 140px),
    var(--card-bg);

  -webkit-overflow-scrolling: touch;

  outline: 1px solid rgba(255,255,255,0.18);
  outline-offset: -1px;
}

/* handle */
.drawer.drawer-panel::after{
  content:"";
  position:absolute;
  left: 18px;
  top: calc(env(safe-area-inset-top) + 10px);
  width: 44px;
  height: 5px;
  border-radius: 999px;
  background: rgba(0,0,0,0.10);
  box-shadow:
    0 1px 0 rgba(255,255,255,0.60) inset,
    0 1px 2px rgba(0,0,0,0.08);
  pointer-events:none;
}

/* title */
.drawer-title{
  margin: 0 0 2px 0;
  font-size: 18px;
  font-weight: 900;
  letter-spacing: -0.2px;
  color: var(--text);

  padding: 10px 12px;
  border-radius: 16px;
  background: rgba(255,255,255,0.38);
  border: 1px solid rgba(0,0,0,0.06);
  box-shadow: 0 1px 0 rgba(255,255,255,0.55) inset;
}

/* items */
.drawer-item{
  width: 100%;
  border-radius: 18px;
  padding: 14px 14px;

  font-size: 18px;
  font-weight: 900;
  letter-spacing: -0.2px;

  color: var(--text);
  text-align: left;
  cursor: pointer;

  background: rgba(255,255,255,0.62);
  border: 1px solid rgba(0,0,0,0.06);

  box-shadow:
    0 10px 22px rgba(0,0,0,0.06),
    0 1px 0 rgba(255,255,255,0.55) inset;

  transition: transform .12s ease, opacity .15s ease, background-color .15s ease;
}

.drawer-item:active{
  transform: scale(.99);
  opacity: .75;
}

.drawer-item.danger{
  background: rgba(217,74,74,0.10);
  border: 1px solid rgba(217,74,74,0.18);
  color: #b33b3b;

  box-shadow:
    0 10px 22px rgba(217,74,74,0.06),
    0 1px 0 rgba(255,255,255,0.45) inset;
}

/* =========================
   UI Modal (ui.alert / ui.confirm / ui.prompt)
   ========================= */

.ui-modal-backdrop{
    position:fixed; inset:0;
    background: rgba(0,0,0,.35);
    backdrop-filter: blur(6px);
    -webkit-backdrop-filter: blur(6px);
    display:none;
    z-index: 99999;
    padding: calc(env(safe-area-inset-top) + 16px) 16px calc(env(safe-area-inset-bottom) + 16px);
  }
  .ui-modal-backdrop.show{ display:grid; place-items:center; }

  .ui-modal{
    width: min(520px, 100%);
    background: var(--card-bg, rgba(255,255,255,.78));
    border: 1px solid rgba(0,0,0,.08);
    border-radius: calc(var(--radius, 22px) + 6px);
    box-shadow: 0 18px 50px rgba(0,0,0,.18);
    overflow:hidden;
  }
  .ui-modal-head{
    padding: 16px 16px 10px;
  }
  .ui-modal-title{
    margin:0;
    font-size:18px;
    font-weight:900;
    letter-spacing:-.2px;
    color: var(--text, #3c3c3c);
  }
  .ui-modal-msg{
    margin:8px 0 0;
    font-size:14px;
    font-weight:800;
    line-height:1.5;
    color: var(--secondary, #8e8e93);
    white-space:pre-wrap;
  }
  .ui-modal-body{
    padding: 0 16px 14px;
  }
  .ui-modal-input{
    width:100%;
    border-radius: 14px;
    border: 1px solid rgba(0,0,0,.10);
    background: rgba(255,255,255,.65);
    padding: 12px 12px;
    font-weight:900;
    font-size:16px;
    color: var(--text, #3c3c3c);
    outline:none;
  }
  .ui-modal-input:focus{
    border-color: rgba(0,0,0,.18);
  }
  .ui-modal-actions{
    display:flex;
    gap:10px;
    padding: 14px 16px 16px;
    justify-content:flex-end;
    border-top: 1px solid rgba(0,0,0,.06);
    background: rgba(255,255,255,.40);
  }
  .ui-btn{
    border:0;
    border-radius: 14px;
    padding: 12px 14px;
    font-weight:900;
    cursor:pointer;
    background: rgba(255,255,255,0.70);
    border:1px solid rgba(0,0,0,0.06);
    color: var(--text, #3c3c3c);
    -webkit-tap-highlight-color: transparent;
  }
  .ui-btn:active{ opacity:.75; transform: scale(.99); }
  .ui-btn.primary{
    background: var(--accent-text, #d61c68);
    color:#fff;
    border:0;
  }
  .ui-btn.danger{
    background: rgba(217,74,74,0.12);
    border: 1px solid rgba(217,74,74,0.20);
    color: #b33b3b;
  }